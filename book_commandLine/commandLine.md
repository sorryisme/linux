# 커맨드라인 완벽 입문서



## 1. 쉘

- 키보드로 입력한 명령어를 운영체제에 전달
- 리눅스 배포판은 bash라는 쉘 프로그램 제공
- 쉘 프롬프트에서 # 표시라면 슈퍼유저 권한을 가진 것



### 간단한 명령어 실행

- date : 현재시간과 날짜 표시
- cal : 달력 표시
- df : 사용가능한 디스크 표시
- free : 메모리 사용정보





## 2. 파일시스템 탐색

- pwd : 현재 디렉토리 표시
- cd : 디렉토리 변경
- ls : 디렉토리 나열



### 파일시스템 트리 구조의 이해

- 계층적 디렉토리 구조로 파일을 구성
- 최상위 디렉토리를 루트 디렉토리라고 칭함



### 절대 경로 

- 루트 디렉토리에서 원하는 디렉토림까지 하나씩 명시하는 것

  

### 상대 경로

- 현재 디렉토리 기준으로 목적지를 명시
  - .  현재 디렉토리
  - .. 상위 디렉토리



### 유용한 단축 표현들

- cd : 홈디렉토리로 변경
- cd - : 이전 디렉토리로 이전
- cd ~username : username의 home 디렉토리로 이동




## 3. 시스템 살펴보기

- ls : 디렉토리 내용 나열하기
- file : 파일타입 확인하기
- less : 파일 내용 표시하기



## ls

- 한 번에 여러 디렉토리를 볼 수 있다.
  - ls ~ /usr /var : 동시에 여러 디렉토리를 한 번에 본다

```java
명령어 Long 옵션은 -- (대시 대시) 기호를 사용 

일반 옵션은 - (대시) 기호 사용
```



- 파일 수정 시간에 따른 결과를 보고 싶다면
  - ls -lt
- 파일 수정 시간 역순으로 보고 싶다면
  - ls -lt reverse



### 그 외 자주 사용하는 옵션

- -a : 모든 파일 및 숨김 파일 보기
- -h : 파일 크기를 보기 좋게표시
- -s : 파일 크기 순으로 정렬
- -t : 수정 시간 순으로 정렬
- -r : 역순 정렬



## file

- file 명령어로 file 타입을 확인할 수 있다.



## less 

- 텍스트 파일을 볼 때 사용하는 프로그램
  - less [filename]
- less 명령키
  - b : 한페이지 위로
  - [스페이스바] : 한페이지 아래
  - G : 맨 마지막 이동
  - 1G  또는 g : 파일 맨 처음 이동
  - /문자열 : 문자열 찾기
  - n : 검색 다음 찾기



## 리눅스 시스템 디렉토리

- bin : 실행에 필요한 바이너리 파일
- dev : 디바이스 관리
- etc : 시스템 전반 환경설정 파일 , 쉘 스크립트
  - /etc/crontab : 자동 실행 업무
  - /etc/fstab : 마운트 포인트
  - /etc/passwd : 사용자 계정정보
- lib : 공유 라이브러리 파일 폴더
- media : 휴대용 장치 자동 마운트 위치
- opt : 상업용 소프트웨어 설치 
- sbin : 시스템 바이너리 파일 , 슈퍼유저를 위한 시스템 작업 
- tmp : 임시 저장용
- usr : 일반 사용자가 사용하는 모든 프로그램과 지원 파일
- usr/bin : 리눅스 배포판이 설치한 프로그램
- usr/lib : usr/bin을 위한 라이브러리 공간
- usr/local : 시스템 전반에 걸쳐 사용되는 프로그램 저장 공간
- usr/share : 공유 폴더
- var : 상대적으로 변하기 쉬운 데이터(db, 스풀 파일, 사용자메일)
- var/log : 시스템 로그 파일




## 4. 파일과 디렉토리 조작

- cp : 파일 및 디렉토리 복사
- mv : 파일 및 디렉토리 이동, 이름바꾸기
- mkdir : 디렉토리 만들기
- rm : 디렉토리삭제
- ln : 하드링크 또는 심볼릭 링크 만들기  



### 와일드 카드

- '*' : 모든 문자

- ? : 모든 하나의 문자

- [characters] : 문자셋에 포함된 문자

- [[:class:]] : 지정된 문자 클래스에 포함된 문자
  - [:alnum:] : 모든 알파벳과 숫자문자
  - [:alpha:] : 모든 알파벳 문자
  - [:digit:] : 모든 숫자
  - [:lower:] : 모든 소문자
  - [:upper:] :모든 대문자



### mkdir 

- 디렉토리 생성
- mkdir dir1 dir2 dir3 : 디렉토리 총 3개 생성



### cp 

- cp [item1] [item2] :
- 옵션 
  - -a : 소유 권한,정보 같은 속성까지 복사
  - -i : 덮어쓰기 전에 확인 메세지, 없으면 그냥 덮어씀
  - -r : 디렉토리 그 안 내용까지 복사
  - -u : 디렉토리에 없거나 최신 버전으로 업데이트
  - -v : 복사 완료 메세지

### mv

- mv [item1] [item2]
- 옵션
  - -i : 덮어쓰기전 확인 메시지
  - -u : 없거나 최신 버전인 파일만 이동
  - -v : 이동 완료시 메세지



### rm

- -i : 삭제하기 전 메세지 
- -r : 재귀적으로 파일 삭제
- -f : 존재하지 않은 파일은 확인 메시지 없이 무시
- -v : 삭제 완료 메세지



### ln

- 링크 생성

- 하드링크

  - 같은 디스크 파티션만 참조할 수 있음
  - 디렉토리 참조 불가
  - ln [링크할 파일] [하드링크 파일명]

- 심볼릭 링크

  - 바로가기와 흡사
  - ls 명령어로 깨진 링크는 원본이 삭제 된 것
  - ls -s [링크할 파일 또는 폴더] [심볼릭 링크 파일명]

  
  

## 5. 명령어와 친해지기

- type : 명령어의 이름이 어떻게 표시되는지 확인
- which : 실행프로그램 위치 표시
- man : 명령어 man 페이지 표시
- apropos : 적합한 명령어 리스트 표시
- info : 명령어 정보 표시
- whatis : 명령어에 대한 짧은 표시
- alias : 명령어 별칭 붙이기



### 명령어란?

- /usr/bin 디렉토리에 있는 파일처럼 실행 프로그램
- 쉘에 저장된 명령어
- 쉘 함수
- 명령어란 별칭



- type

  - 명령어 타입 확인
  - type [command]

- which

  - 실행 파일 위치 표시
  - which [command]

- alias 

  - 명령어 커스텀마이징
  - alias [name]='[command]'

  ```
  ex:)
  alias remotepi='ssh pi@192.168.***.***'
  ```

- unalias

  - 별칭삭제
  - unalias [name]




## 6. 리다이렉션

- cat : 파일 연결하기
- sort : 텍스트 라인 정렬
- uniq : 중복 줄 알리거나 생략
- wc : 파일의 개행 및 단어 갯수, 파일 바이트 출력
- grep : 패턴 일치하는 라인 출력
- head : 파일 첫 부분 출력
- tail : 파일 마지막 부분 출력
- tee : 표준 입력 파일 읽고 표준 출력 및 파일쓰기



### 표준출력 재지정

- ' > ' : 리다이렉션 연산자
  - 출력결과를 파일로 저장
- '>>' : 리다이렉션 추가
  - 파일 덮어쓰기 대신 추가
- '2>' : 표준 오류 재지정
  - 에러 발생 시 파일 저장
  - ls -l /bin/usr 2> ls-error.txt
- 표준출력과 표준 오류를 한 파일로 재지정(2rkwl wnd tjsxor)
  - ls -l /bin/usr > ls-output.txt 2>&1
  - ls -l /bin/usr &> ls-output.txt

---

- cat : 파일 붙이기
  - 하나 이상의 파일을 읽어 들여 표준 출력으로 복사
  - ex) 파일 여러 개의 내용을 하나로 합칠 때 mpeg.001, mpeg.002 ....
    -  cat movie.mpeg.0* > movie.mpeg



### 파이프라인 

- 표준 출력을 다른 명령어의 표준 입력과 연결시킬 수 있다.
  - ls -l /usr/bin | less
- 필터 
  - sort : 정렬	
    - ls /bin /usr/bin | sort | less
  - uniq : 중복줄 제거 및 표시
    - ls /bin /usr/bin | sort | uniq | less
  - uniq -d : 중복된 내용만 확인
    - ls /bin /usr/bin | sort | uniq -d | less



- wc : 라인 단어 갯수 및 파일크기 출력
- grep : 파일 텍스트 패턴 찾을 때 사용
- head / tail : 파일의 첫 부분 끝 부분 출력
  - -f : 지속적으로 파일감시
- tee : 표준 입력에서 데이터 읽고 표준 출력과 파일에 출력




## 7. 확장과 인용

- echo : 텍스트 라인 표시
  - 명령어를 입력하고 엔터키를 누르면 bash는 몇 가지 프로세스를 진행
  - 프로세스를 확인하기 위해서 echo 명령어 사용

### 산술확장

- $((expression))

### 중괄호 확장

- echo Number_{1..5}
  - Number1, Number2, Number3, Number4, Number5
- mkdir {2009..2011}-{1..9} {2009..2011}-{10.12}

### 매개변수 확장

- echo $USER

### 명령어 치환

- echo $(ls)



## 8. 고급 키보드 기법

- clear : 화면 지우기
- history : 히스토리 표시하기



### 커맨드 라인 편집

- 커서 이동 명령어
  - CTRL + A : 맨 앞으로 커서 이동 [ Ahead]
  - CTRL + E : 맨 뒤로 커서 이동 [ End ]
  - CTRL + F : 다음 한글자 커서 이동 [Forward]
  - CTRL + B : 이전 한글자 커서 이동 [Backward]
  - ALT + F : 다음 단어 한글자 이동 [Forward]
  - ALT + B : 이전 단어 한글자 이동 [Backward]
  - CTRL + L : 하면 지우고 왼쪽 커서 최상단 이동
- 텍스트 편집 명령어
  - CTRL + D : 커서 위치에 있는 글자 지우기 [ DELETE]
  - CTRL + T : 현재 커서 위치 글자와 바로 앞 글자 위치 바꾸기
  - ATL + T : 현재 커서 위치에 있는 단어와 앞 단어 위치 바꾸기 
  - ALT + L : 현재 커서 위치에 있는 글자부터 그 단어 끝 부분까지 소문자로 바꾸기 [ Lower ]
  - ALT + U : 현재 커서 위치에 있는 글자부터 그 단어 끝 부분까지 대문자로 바꾸기 [ Upper ]
- 잘라내기/붙이기 명령어
  - CTRL + K : 현재 커서부터 그 줄 끝부분까지 텍스트 지우기
  - CTRL + U : 현재 커서부터 처음부분까지 텍스트 지우기
  - ALT + D : 현재 커서 위치부터 그 단어 끝 부분까지 텍스트 지우기
  - ALTER + BACKSPACE : 커서 위치부터 그 단어 앞부분 까지 텍스트 삭제하기
  - CTRL + Y : 현재 텍스트를 복사해서 현재 커서 위치에 삽입



### 히스토리

- 입력된 명령어의 히스토리를 확인함
- 히스토리 확장
  - ! [history 번호를 입력]
  - CTRL + R 로 검색 
- 히스토리 명령어
  - CTRL + P : 이전 히스토리 [Previous]
  - CTRL + N : 다음 히스토리 [Next]
  - ALT + < : 히스토리 목록 처음으로 이동
  - ALT + > : 히스토리 목록 마지막으로 이동
- 히스토리 확장 명령어
  - !! : 마지막 명령어 반복실행
  - !number : 이 번호에 해당하는 항목을 실행
  - !string : 이 문자열로 시작하는 가장 최근 항목 실행
  - !?string : 이 문자열로 포함된 가장 최근에 입력 항목 실행



## 9. 퍼미션

- 멀티유저 지원
  - 수년 전 컴퓨터가 "개인용"이 되기 전에는 매우 크고 비싸고 중앙 집권적
  - 여러 사용자가 하나의 컴퓨터에 접근해서 컴퓨터를 고장내는 것을 방지하기 위해 멀티유저 지원
- id : 사용자 Id정보
- chmod : 파일모드 변경
- Umask : 기본 파일 퍼미션 설정
- su : 다른 사용자로 쉘을 실행
- sudo : 다른 사용자로 명령어 실행
- chown : 파일 소유자 변경
- chgrp : 파일 그룹 소유자 변경
- passwd : 사용자 비밀번호 변경



### 소유자, 그룹멤버, 기타사용자

- id : 계정정보 확인
  - uid : 사용자 번호 
  - gid : 그룹번호
- 사용자 계정 정보 위치
  - /etc/passwd
- 그룹 계정 정보 위치
  - /etc/group
- 유닉스형 시스템
  - 일반 사용자를 users와 같은 일반 그룹에 할당
- 리눅스형 시스템
  - 동일한 유일한 그룹에 하나의 멤버만 할당



### 읽기, 쓰기, 실행

- drwxrwxrwx
  - 파일의 종류
  - Owner 퍼미션
  - Group 퍼미션
  - World 퍼미션
- r  
  - file - 파일 열기와 읽기 허용
  - dir - 디렉토리의 내용물을 나열할 수 있도록 함
- w 
  - file - 파일쓰기와 잘라내기는 허용, 파일 삭제나 파일 이름 변경은 디렉토리 속성에 결정됨
  - dir - 디렉ㅌ코리 파일 생성, 삭제, 이름 변경이 가능하게 한다
- x 
  - file - 파일이 실행되도록 허용, 대신 스크립트는 읽기 가능해야한다
  - dir - 디렉토리에 들어올 수 있도록한다 

### chmod

- 8진법 표현
  - 421 순으로 rwx를 표현
  - rwx를 사용
- 기호표현
  - u : 파일이나 디렉토리 소유를 의미
  - g : 그룹 소유자
  - o : 기타 사용자
  - a : all, 모든 사용자
- 기호 표현 예시
  - u+x : 소유자에게 실행 권한 추가
  - o-rw : 읽기,쓰기 권한 제거
  - go=rw : 그룹 ,기타 사용자 읽기 쓰기 권한 부여

### 사용자 아이디 변경

- 로그아웃 후 다른 사용자 로그인
- su 명령어 사용
- sudo 명령어 사용
  - /etc/sudoers 설정 파일을 설정하게 하여 권한을 부여



- su 
  - su [-[l]] [user]
    - -l : 반환된 쉘 세션은 로그인 쉘이 된다. 
    - 주로 l을 생략하고 'su -'를 많이 사용한다
      - 홈 디렉토리는 /root가 된다
      - $가 아닌 # [슈퍼유저 표시]가 나타난다
- sudo
  - su와 다른 점은 통제된 명령 실행을 가능하게 한다
  - sudo는 슈퍼유저의 비밀번호를 요구하지 않는다
- chown
  - 첫번째 인자로 파일 소유자 파일 그룹 소유자를 변경 가능
    - chown bob [file] : 파일 소유자를 bob으로 변경
    - chown bob:users   : 파일 소유자를 bob 그룹 소유자를 users로
    - :admins : 파일 그룹 소유자를 admins로
    - bob:  : 파일 소유자가 bob이고 그룹 소유자가 bob 로그인 그룹으로 변경
- passwd [user] 
  - 사용자 비밀번호 변경



## 10. 프로세스

- 프로세스란 리눅스가 CPU를 사용하기 위해 차례를 기다리는 프로그램을 구조화 하는 것



- ps : 현재 프로세스 상태
- top : 프로세스 표시
- jobs : 실행 작업 나열
- bg : 프로세스 백그라운 상태로 전환
- fg : 프로세스 포그라운드 상태로 전환
- kill : 프로세스에 시그널 전달
- killall : 프로세스 명으로 프로세스 종료
- shutdown : 시스템 종료 재시작



### 프로세스 동작 방식

- 시스템 구동 시 프로세스 초기화 하고 init 프로그램 실행
  - init 쉘 스크립트는 /etc에 위치
  - 많은 서비스들은 데몬 프로그램으로 구현
    - 백그라운드 상태로 동작
  - 프로세스를 구조화 된 형태로 유지하기 위해 프로세스 정보 보유
    - 프로세스 ID
- ps
  - ps는 현재 터미널 세션과 관련된 프로세스만 보여준다
  - TTY는 teletype의 약자 : 제어터미널
- ps x : 시스템 전체 상황
  - x : 터미널에 상관 없는 모든 프로세스를 보여준다
    - TTY '?' 표시는 아무런 제어터미널이 없다는 뜻
  - 출력 결과 stat이라는 항목은 현재 상태를 나타낸다
    - R : 실행 중이거나 실행 대기중 [Running]
    - S : 수면 상태, 키 입력이나 네트워크 패킷 같은 이벤트를 기다린다. [Sleep]
    - D : 인터럽트 불가능한 수면상태 프로세스 I/O를 기다린다. 
    - T : 종료 상태 [Terminal]
    - Z : 현존하지 않거나 좀비 프로세스 [Zombie]
    - < : 높은 우선 순위 프로세스
    - N : 낮은 우선순위 프로세스 [nice process]



- ps aux : 모든 사용자에 속한 프로세스들을 보여준다

  - VSZ : 가상메모리 크기
  - RSS : 사용 메모리 크기 , 프로세스가 사용 중인 물리적 메모리
  - START : 프로세스 시작 시간

- top : 동적인 프로세스 활동

  - load average : 실행 대기 중인 프로세스 수 

    - 60초, 5분, 15분 순으로 표기되며 1보다 작으면 바쁘지 않다는 것을 뜻함


### 프로세스 제어

- 프로세스 백그라운드로 전환
  - [프로그램 실행] &
- jobs : 프로그램 목록
- fg %[작업번호] :  백그라운드 포그라운드로 전환
- CTRL + Z : 프로그램 일시정지



### 시그널

- kill [-signal] [PID] : 프로세스에 시그널 보내기
  - 시그널 정보가 없으면 TERM(종료) 시그널이 전달된다.
- 주요 시그널
  - 1 (HUP) : Hang up 의 뜻 터미널 세션 종료에 의해 나타나며, 포그라운드 프로그램은  시그널을 받으면 종료
  - 2 (INT) : interrupt의 뜻 CTRL + C와 동일한 기능
  - 9(KILL) : 시그널을 무시하고 커널이 즉시 프로그램 종료
  - 15(TERM) : Terminate 시그널을 받을 수 있으면 종료
  - 18(CONT) : continue 멈춰진 프로세스 복원
  - 19(STOP) : 일시정지, kill과 동일하게 프로세스로 전달되지 않는다.



### 기타 프로세스 명령어

- pstree : 프로세스 목록을 트리구조로 출력
- vmstat : 메모리 스왑, 디스크 I/O를 포함한 시스템 자원현황을 출력
  - 시간 지연 값과 함께 사용할 수 있음 예:)vmstat 5
- xload : 시간에 따라 시스템 부하를 그래프로 보여줌
- tload : 터미널을 통해 그래프를 보여줌


## 11. 환경

- printenv : 환경 일부 또는 전체 출력하기

- set : 쉘 옵션 설정하기

- export : 다음 실행 프로그램에 환경 적용하기

- alias : 명령어 별칭 생성하기

  